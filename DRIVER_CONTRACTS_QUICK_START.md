# ุฎุทูุงุช ุชูููุฐ ูุธุงู ุนููุฏ ุงูุณุงุฆููู ุงูููุญุฏูุซ

## 1. ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุทููุจ)

### ุชุดุบูู ุงูุณูุฑูุจุชุงุช ุจุงูุชุฑุชูุจ:

```sql
-- A. ุชุญุฏูุซ ุฌุฏูู drivercontracts (ุฅุถุงูุฉ mine_id ู project_contract_id)
SOURCE c:\xamppnew\htdocs\emstest\database\add_mine_id_to_drivercontracts.sql;

-- B. ุฅูุดุงุก ุฌุฏูู driver_contract_notes (ุณุฌู ุงูุฅุฌุฑุงุกุงุช)
SOURCE c:\xamppnew\htdocs\emstest\database\create_driver_contract_notes_table.sql;

-- C. ุฅูุดุงุก ุฌุฏูู drivercontractequipments (ุงุฎุชูุงุฑู - ูุฅุฏุงุฑุฉ ูุนุฏุงุช ุงูุนููุฏ)
SOURCE c:\xamppnew\htdocs\emstest\database\create_drivercontractequipments_table.sql;
```

**ุฃู ุนู ุทุฑูู phpMyAdmin:**
- ุงูุชุญ phpMyAdmin โ ูุงุนุฏุฉ `equipation_manage`
- ุนูุงูุฉ ุชุจููุจ SQL โ ุงูุณุฎ ูุญุชูู ูู ููู ูุดุบููู

---

## 2. ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ (ุฅุฐุง ูุงูุช ูุฏูู ุนููุฏ ูุฏููุฉ)

```sql
-- ุฑุจุท ุงูุนููุฏ ุงููุฏููุฉ ุจุงูููุงุฌู ูุงูุนููุฏ (ุชููุงุฆู ุญูุซ ุฃููู)
UPDATE drivercontracts dc
LEFT JOIN (
    SELECT c.id, c.mine_id, c.project_id 
    FROM contracts c 
    WHERE c.status = 1
) c ON c.project_id = dc.project_id
SET 
    dc.mine_id = c.mine_id,
    dc.project_contract_id = c.id
WHERE dc.mine_id IS NULL AND c.id IS NOT NULL
LIMIT 1000;
```

**ููุงุญุธุฉ:** ูุฏ ุชุญุชุงุฌ ูุชุญุฏูุซ ุจุนุถ ุงูุนููุฏ ูุฏููุงู ุฅุฐุง ูุงู ุงููุดุฑูุน ูุญุชูู ุนูู ุนุฏุฉ ููุงุฌู/ุนููุฏ.

---

## 3. ุงุฎุชุจุงุฑ ุงููุธุงู

### A. ุฅูุดุงุก ุนูุฏ ุฌุฏูุฏ:
1. ุงูุชุญ: `http://localhost/emstest/Drivers/drivers.php`
2. ุงุฎุชุฑ ุณุงุฆู โ "ุนููุฏ" โ "ุฅุถุงูุฉ ุนูุฏ ุณุงุฆู"
3. ุงุฎุชุฑ **ุงููุดุฑูุน** โ ูุฌุจ ุฃู ุชุธูุฑ ูุงุฆูุฉ **ุงูููุงุฌู**
4. ุงุฎุชุฑ **ุงูููุฌู** โ ูุฌุจ ุฃู ุชุธูุฑ ูุงุฆูุฉ **ุงูุนููุฏ**
5. ุงุฎุชุฑ **ุงูุนูุฏ** โ ุฃููู ุงูุจูุงูุงุช โ ุงุญูุธ
6. ุชุญูู ูู ุธููุฑ ุงูุนูุฏ ูู ุงูุฌุฏูู ูุน ูุนูููุงุช ุงููุดุฑูุน + ุงูููุฌู + ุฑูู ุงูุนูุฏ

### B. ุนุฑุถ ุชูุงุตูู ุนูุฏ:
1. ูู ุฌุฏูู ุงูุนููุฏ โ ุงููุฑ ุนูู ุฃููููุฉ "๐๏ธ ุนุฑุถ"
2. ูุฌุจ ุฃู ุชูุชุญ ุตูุญุฉ: `drivercontracts_details.php?id=X`
3. ุชุญูู ูู ุธููุฑ:
   - ุงุณู ุงูุณุงุฆู
   - ุงููุดุฑูุน - ุงูููุฌู (ุงูููุฏ) - ุนูุฏ #ุฑูู
   - ุฌููุน ุชูุงุตูู ุงูุนูุฏ
   - ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช (6 ุฃุฒุฑุงุฑ)

### C. ุงุฎุชุจุงุฑ ุงูุฅุฌุฑุงุกุงุช:

#### ุชุฌุฏูุฏ ุงูุนูุฏ (Renewal):
1. ุงููุฑ "ุชุฌุฏูุฏ ุงูุนูุฏ"
2. ุฃุฏุฎู ุชุงุฑูุฎ ุจุฏุงูุฉ ุฌุฏูุฏ ูุชุงุฑูุฎ ููุงูุฉ
3. ุงุญูุธ โ ุชุญูู ูู ุงูุชุญุฏูุซ

#### ุชุณููุฉ ุงูุนูุฏ (Settlement):
1. ุงููุฑ "ุชุณููุฉ ุงูุนูุฏ"
2. ุงุฎุชุฑ ุฒูุงุฏุฉ/ููุตุงู
3. ุฃุฏุฎู ุนุฏุฏ ุงูุณุงุนุงุช ูุงูุณุจุจ
4. ุงุญูุธ โ ุชุญูู ูู ุชุญุฏูุซ ุงูุณุงุนุงุช

#### ุฅููุงู ุงูุนูุฏ (Pause):
1. ุงููุฑ "ุฅููุงู ุงูุนูุฏ"
2. ุฃุฏุฎู ุงูุณุจุจ ูุงูุชุงุฑูุฎ
3. ุงุญูุธ โ ุชุญูู ูู ุชุบููุฑ ุงูุญุงูุฉ ุฅูู "ููููู"

#### ุงุณุชุฆูุงู ุงูุนูุฏ (Resume):
1. ุงููุฑ "ุงุณุชุฆูุงู ุงูุนูุฏ"
2. ุงุฎุชุฑ ุทุฑููุฉ ุงููุนุงูุฌุฉ (ุชูุฏูุฏ/ุฎุตู ุฃูุงู ุงูุฅููุงู)
3. ุงุญูุธ โ ุชุญูู ูู ุนูุฏุฉ ุงูุญุงูุฉ ุฅูู "ุณุงุฑู"

#### ุฅููุงุก ุงูุนูุฏ (Terminate):
1. ุงููุฑ "ุฅููุงุก ุงูุนูุฏ"
2. ุงุฎุชุฑ ููุน ุงูุฅููุงุก (ุนุงุฏู/ูุจูุฑ)
3. ุฃุฏุฎู ุงูุณุจุจ
4. ุงุญูุธ โ ุชุญูู ูู ุชุบููุฑ ุงูุญุงูุฉ

#### ุฏูุฌ ุนููุฏ (Merge):
1. ุงููุฑ "ุฏูุฌ ุนููุฏ"
2. ุงุฎุชุฑ ุงูุนูุฏ ุงูุขุฎุฑ ูู ููุณ ุงูุณุงุฆู ูุงููุดุฑูุน
3. ุงุญูุธ โ ุชุญูู ูู ููู ุงูุณุงุนุงุช ููุถุน ุนูุงูุฉ ุนูู ุงูุนูุฏ ุงููุฏููุฌ

---

## 4. ุงูุชุญูู ูู ุณุฌู ุงูุฅุฌุฑุงุกุงุช

```sql
-- ุนุฑุถ ุขุฎุฑ 10 ุฅุฌุฑุงุกุงุช ุนูู ุนููุฏ ุงูุณุงุฆููู
SELECT dcn.*, dc.id AS contract_number, d.name AS driver_name
FROM driver_contract_notes dcn
LEFT JOIN drivercontracts dc ON dcn.contract_id = dc.id
LEFT JOIN drivers d ON dc.driver_id = d.id
ORDER BY dcn.created_at DESC
LIMIT 10;
```

---

## 5. ุงููููุงุช ุงูุฌุฏูุฏุฉ/ุงููุญุฏุซุฉ

### โ ุชู ุฅูุดุงุคูุง:
- `Drivers/drivercontracts_details.php` - ุตูุญุฉ ุชูุงุตูู ุงูุนูุฏ
- `Drivers/driver_contract_actions_handler.php` - ูุนุงูุฌ API ููุฅุฌุฑุงุกุงุช
- `Drivers/get_driver_contract_equipments.php` - endpoint ุงููุนุฏุงุช
- `Drivers/README_DRIVER_CONTRACTS_UPDATE.md` - ุงูุฏููู ุงููุงูู

### โ ุชู ุชุญุฏูุซูุง:
- `Drivers/drivercontracts.php` - ุฅุถุงูุฉ ุงูููุงุฆู ุงููุชุชุงููุฉ 3 ูุณุชููุงุช
- `database/equipation_manage.sql` - ุชุญุฏูุซ schema

### โ ุณูุฑูุจุชุงุช ุงูุชุฑุญูู:
- `database/add_mine_id_to_drivercontracts.sql`
- `database/create_driver_contract_notes_table.sql`
- `database/create_drivercontractequipments_table.sql`

---

## 6. ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ููุงุฆู ุงูููุงุฌู/ุงูุนููุฏ ูุง ุชุธูุฑ
**ุงูุญู:**
- ุงูุชุญ Console ูู ุงููุชุตูุญ (F12)
- ุงุจุญุซ ุนู ุฃุฎุทุงุก JavaScript
- ุชุญูู ูู ูุฌูุฏ ูููุงุช:
  - `Suppliers/get_project_mines.php`
  - `Suppliers/get_mine_contracts.php`

### ุงููุดููุฉ: ุฎุทุฃ ูู ุญูุธ ุงูุนูุฏ
**ุงูุญู:**
- ุชุญูู ูู ุชุดุบูู ุณูุฑูุจุช `add_mine_id_to_drivercontracts.sql`
- ุชุฃูุฏ ูู ุฃู ุงูุญููู `mine_id` ู `project_contract_id` ููุฌูุฏุฉ ูู ุงูุฌุฏูู

### ุงููุดููุฉ: ุงูุฅุฌุฑุงุกุงุช ูุง ุชุนูู
**ุงูุญู:**
- ุชุญูู ูู ูุฌูุฏ ููู `driver_contract_actions_handler.php`
- ุชุญูู ูู ุชุดุบูู ุณูุฑูุจุช `create_driver_contract_notes_table.sql`
- ุงูุญุต ุฃุฎุทุงุก PHP ูู ููู error_log

### ุงููุดููุฉ: ุตูุญุฉ ุงูุชูุงุตูู ูุง ุชูุชุญ
**ุงูุญู:**
- ุชุญูู ูู ูุฌูุฏ ููู `drivercontracts_details.php`
- ุชุฃูุฏ ูู ุชูุฑูุฑ `id` ูู ุงูุฑุงุจุท: `?id=X`
- ุงูุญุต ุงุณุชุนูุงู SQL ูู ุงูููู

---

## 7. ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

### A. ุฅุถุงูุฉ Foreign Keys (ููุญูุงูุฉ)
```sql
ALTER TABLE drivercontracts
ADD CONSTRAINT fk_drivercontracts_mine 
FOREIGN KEY (mine_id) REFERENCES mines(id) ON DELETE SET NULL;

ALTER TABLE drivercontracts
ADD CONSTRAINT fk_drivercontracts_project_contract 
FOREIGN KEY (project_contract_id) REFERENCES contracts(id) ON DELETE SET NULL;
```

### B. ุฅูุดุงุก ุชูุงุฑูุฑ ููุณุงุฆููู
- ูุณุฎ ุชูุงุฑูุฑ ุงูููุฑุฏูู ูุชุนุฏูููุง ููุณุงุฆููู
- ุฅุถุงูุฉ ุฅุญุตุงุฆูุงุช ูุณุงุนุงุช ุงูุณุงุฆููู ุญุณุจ ุงูููุฌู

### C. ุฑุจุท ุงูุทุจุงุนุฉ
- ุฅุถุงูุฉ ุตูุญุฉ ุทุจุงุนุฉ ูุนูุฏ ุงูุณุงุฆู
- ุชุตุฏูุฑ PDF ูุชูุงุตูู ุงูุนูุฏ

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

ูุจู ุงูุฅุทูุงูุ ุชุฃูุฏ ูู:

- [ ] ุชู ุชุดุบูู ุฌููุน ุณูุฑูุจุชุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (3 ูููุงุช)
- [ ] ุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ (ุฅุฐุง ูุฒู ุงูุฃูุฑ)
- [ ] ุงูููุงุฆู ุงููุชุชุงููุฉ ุชุนูู ุจุดูู ุตุญูุญ
- [ ] ูููู ุฅูุดุงุก ุนูุฏ ุฌุฏูุฏ ุจูุฌุงุญ
- [ ] ุตูุญุฉ ุงูุชูุงุตูู ุชุนุฑุถ ุฌููุน ุงููุนูููุงุช
- [ ] ุฌููุน ุงูุฅุฌุฑุงุกุงุช (6) ุชุนูู ุจุฏูู ุฃุฎุทุงุก
- [ ] ุณุฌู ุงูุฅุฌุฑุงุกุงุช ููุณุฌู ูู ุชุบููุฑ
- [ ] ุงูุฌุฏูู ูุนุฑุถ ูุนูููุงุช ุงููุดุฑูุน + ุงูููุฌู + ุงูุนูุฏ
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console ุฃู PHP logs

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงูุชูุงุตููุ ุฑุงุฌุน:
- `Drivers/README_DRIVER_CONTRACTS_UPDATE.md` - ุงูุฏููู ุงููุงูู
- `.github/copilot-instructions.md` - ุชุนูููุงุช ุงููุธุงู

**ุชู ุจูุฌุงุญ! ๐**
